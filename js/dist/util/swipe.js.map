{"version":3,"file":"swipe.js","sources":["../../src/util/swipe.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap util/swipe.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport EventHandler from '../dom/event-handler.js'\nimport Config from './config.js'\nimport { execute } from './index.js'\n\n/**\n * Constants\n */\n\nconst NAME = 'swipe'\nconst EVENT_KEY = '.bs.swipe'\nconst EVENT_TOUCHSTART = `touchstart${EVENT_KEY}`\nconst EVENT_TOUCHMOVE = `touchmove${EVENT_KEY}`\nconst EVENT_TOUCHEND = `touchend${EVENT_KEY}`\nconst EVENT_POINTERDOWN = `pointerdown${EVENT_KEY}`\nconst EVENT_POINTERUP = `pointerup${EVENT_KEY}`\nconst POINTER_TYPE_TOUCH = 'touch'\nconst POINTER_TYPE_PEN = 'pen'\nconst CLASS_NAME_POINTER_EVENT = 'pointer-event'\nconst SWIPE_THRESHOLD = 40\n\nconst Default = {\n  endCallback: null,\n  leftCallback: null,\n  rightCallback: null\n}\n\nconst DefaultType = {\n  endCallback: '(function|null)',\n  leftCallback: '(function|null)',\n  rightCallback: '(function|null)'\n}\n\n/**\n * Class definition\n */\n\nclass Swipe extends Config {\n  constructor(element, config) {\n    super()\n    this._element = element\n\n    if (!element || !Swipe.isSupported()) {\n      return\n    }\n\n    this._config = this._getConfig(config)\n    this._deltaX = 0\n    this._supportPointerEvents = Boolean(window.PointerEvent)\n    this._initEvents()\n  }\n\n  // Getters\n  static get Default() {\n    return Default\n  }\n\n  static get DefaultType() {\n    return DefaultType\n  }\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n  dispose() {\n    EventHandler.off(this._element, EVENT_KEY)\n  }\n\n  // Private\n  _start(event) {\n    if (!this._supportPointerEvents) {\n      this._deltaX = event.touches[0].clientX\n\n      return\n    }\n\n    if (this._eventIsPointerPenTouch(event)) {\n      this._deltaX = event.clientX\n    }\n  }\n\n  _end(event) {\n    if (this._eventIsPointerPenTouch(event)) {\n      this._deltaX = event.clientX - this._deltaX\n    }\n\n    this._handleSwipe()\n    execute(this._config.endCallback)\n  }\n\n  _move(event) {\n    this._deltaX = event.touches && event.touches.length > 1 ?\n      0 :\n      event.touches[0].clientX - this._deltaX\n  }\n\n  _handleSwipe() {\n    const absDeltaX = Math.abs(this._deltaX)\n\n    if (absDeltaX <= SWIPE_THRESHOLD) {\n      return\n    }\n\n    const direction = absDeltaX / this._deltaX\n\n    this._deltaX = 0\n\n    if (!direction) {\n      return\n    }\n\n    execute(direction > 0 ? this._config.rightCallback : this._config.leftCallback)\n  }\n\n  _initEvents() {\n    if (this._supportPointerEvents) {\n      EventHandler.on(this._element, EVENT_POINTERDOWN, event => this._start(event))\n      EventHandler.on(this._element, EVENT_POINTERUP, event => this._end(event))\n\n      this._element.classList.add(CLASS_NAME_POINTER_EVENT)\n    } else {\n      EventHandler.on(this._element, EVENT_TOUCHSTART, event => this._start(event))\n      EventHandler.on(this._element, EVENT_TOUCHMOVE, event => this._move(event))\n      EventHandler.on(this._element, EVENT_TOUCHEND, event => this._end(event))\n    }\n  }\n\n  _eventIsPointerPenTouch(event) {\n    return this._supportPointerEvents && (event.pointerType === POINTER_TYPE_PEN || event.pointerType === POINTER_TYPE_TOUCH)\n  }\n\n  // Static\n  static isSupported() {\n    return 'ontouchstart' in document.documentElement || navigator.maxTouchPoints > 0\n  }\n}\n\nexport default Swipe\n"],"names":["NAME","EVENT_KEY","EVENT_TOUCHSTART","EVENT_TOUCHMOVE","EVENT_TOUCHEND","EVENT_POINTERDOWN","EVENT_POINTERUP","POINTER_TYPE_TOUCH","POINTER_TYPE_PEN","CLASS_NAME_POINTER_EVENT","SWIPE_THRESHOLD","Default","endCallback","leftCallback","rightCallback","DefaultType","Swipe","_Config","element","config","_this","call","_element","isSupported","_assertThisInitialized","_config","_getConfig","_deltaX","_supportPointerEvents","Boolean","window","PointerEvent","_initEvents","_inheritsLoose","_proto","prototype","dispose","EventHandler","off","_start","event","touches","clientX","_eventIsPointerPenTouch","_end","_handleSwipe","execute","_move","length","absDeltaX","Math","abs","direction","_this2","on","classList","add","pointerType","document","documentElement","navigator","maxTouchPoints","_createClass","key","get","Config"],"mappings":"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"}