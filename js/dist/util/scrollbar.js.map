{"version":3,"file":"scrollbar.js","sources":["../../src/util/scrollbar.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap util/scrollBar.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport Manipulator from '../dom/manipulator.js'\nimport SelectorEngine from '../dom/selector-engine.js'\nimport { isElement } from './index.js'\n\n/**\n * Constants\n */\n\nconst SELECTOR_FIXED_CONTENT = '.fixed-top, .fixed-bottom, .is-fixed, .sticky-top'\nconst SELECTOR_STICKY_CONTENT = '.sticky-top'\nconst PROPERTY_PADDING = 'padding-right'\nconst PROPERTY_MARGIN = 'margin-right'\n\n/**\n * Class definition\n */\n\nclass ScrollBarHelper {\n  constructor() {\n    this._element = document.body\n  }\n\n  // Public\n  getWidth() {\n    // https://developer.mozilla.org/en-US/docs/Web/API/Window/innerWidth#usage_notes\n    const documentWidth = document.documentElement.clientWidth\n    return Math.abs(window.innerWidth - documentWidth)\n  }\n\n  hide() {\n    const width = this.getWidth()\n    this._disableOverFlow()\n    // give padding to element to balance the hidden scrollbar width\n    this._setElementAttributes(this._element, PROPERTY_PADDING, calculatedValue => calculatedValue + width)\n    // trick: We adjust positive paddingRight and negative marginRight to sticky-top elements to keep showing fullwidth\n    this._setElementAttributes(SELECTOR_FIXED_CONTENT, PROPERTY_PADDING, calculatedValue => calculatedValue + width)\n    this._setElementAttributes(SELECTOR_STICKY_CONTENT, PROPERTY_MARGIN, calculatedValue => calculatedValue - width)\n  }\n\n  reset() {\n    this._resetElementAttributes(this._element, 'overflow')\n    this._resetElementAttributes(this._element, PROPERTY_PADDING)\n    this._resetElementAttributes(SELECTOR_FIXED_CONTENT, PROPERTY_PADDING)\n    this._resetElementAttributes(SELECTOR_STICKY_CONTENT, PROPERTY_MARGIN)\n  }\n\n  isOverflowing() {\n    return this.getWidth() > 0\n  }\n\n  // Private\n  _disableOverFlow() {\n    this._saveInitialAttribute(this._element, 'overflow')\n    this._element.style.overflow = 'hidden'\n  }\n\n  _setElementAttributes(selector, styleProperty, callback) {\n    const scrollbarWidth = this.getWidth()\n    const manipulationCallBack = element => {\n      if (element !== this._element && window.innerWidth > element.clientWidth + scrollbarWidth) {\n        return\n      }\n\n      this._saveInitialAttribute(element, styleProperty)\n      const calculatedValue = window.getComputedStyle(element).getPropertyValue(styleProperty)\n      element.style.setProperty(styleProperty, `${callback(Number.parseFloat(calculatedValue))}px`)\n    }\n\n    this._applyManipulationCallback(selector, manipulationCallBack)\n  }\n\n  _saveInitialAttribute(element, styleProperty) {\n    const actualValue = element.style.getPropertyValue(styleProperty)\n    if (actualValue) {\n      Manipulator.setDataAttribute(element, styleProperty, actualValue)\n    }\n  }\n\n  _resetElementAttributes(selector, styleProperty) {\n    const manipulationCallBack = element => {\n      const value = Manipulator.getDataAttribute(element, styleProperty)\n      // We only want to remove the property if the value is `null`; the value can also be zero\n      if (value === null) {\n        element.style.removeProperty(styleProperty)\n        return\n      }\n\n      Manipulator.removeDataAttribute(element, styleProperty)\n      element.style.setProperty(styleProperty, value)\n    }\n\n    this._applyManipulationCallback(selector, manipulationCallBack)\n  }\n\n  _applyManipulationCallback(selector, callBack) {\n    if (isElement(selector)) {\n      callBack(selector)\n      return\n    }\n\n    for (const sel of SelectorEngine.find(selector, this._element)) {\n      callBack(sel)\n    }\n  }\n}\n\nexport default ScrollBarHelper\n"],"names":["SELECTOR_FIXED_CONTENT","SELECTOR_STICKY_CONTENT","PROPERTY_PADDING","PROPERTY_MARGIN","ScrollBarHelper","_element","document","body","_proto","prototype","getWidth","documentWidth","documentElement","clientWidth","Math","abs","window","innerWidth","hide","width","_disableOverFlow","_setElementAttributes","calculatedValue","reset","_resetElementAttributes","isOverflowing","_saveInitialAttribute","style","overflow","selector","styleProperty","callback","_this","scrollbarWidth","manipulationCallBack","element","getComputedStyle","getPropertyValue","setProperty","Number","parseFloat","_applyManipulationCallback","actualValue","Manipulator","setDataAttribute","value","getDataAttribute","removeProperty","removeDataAttribute","callBack","isElement","_iterator","_createForOfIteratorHelperLoose","SelectorEngine","find","_step","done","sel"],"mappings":"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"}