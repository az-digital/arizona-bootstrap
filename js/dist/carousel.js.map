{"version":3,"file":"carousel.js","sources":["../src/carousel.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap carousel.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport BaseComponent from './base-component.js'\nimport EventHandler from './dom/event-handler.js'\nimport Manipulator from './dom/manipulator.js'\nimport SelectorEngine from './dom/selector-engine.js'\nimport {\n  defineJQueryPlugin,\n  getNextActiveElement,\n  isRTL,\n  isVisible,\n  reflow,\n  triggerTransitionEnd\n} from './util/index.js'\nimport Swipe from './util/swipe.js'\n\n/**\n * Constants\n */\n\nconst NAME = 'carousel'\nconst DATA_KEY = 'bs.carousel'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\n\nconst ARROW_LEFT_KEY = 'ArrowLeft'\nconst ARROW_RIGHT_KEY = 'ArrowRight'\nconst TOUCHEVENT_COMPAT_WAIT = 500 // Time for mouse compat events to fire after touch\n\nconst ORDER_NEXT = 'next'\nconst ORDER_PREV = 'prev'\nconst DIRECTION_LEFT = 'left'\nconst DIRECTION_RIGHT = 'right'\n\nconst EVENT_SLIDE = `slide${EVENT_KEY}`\nconst EVENT_SLID = `slid${EVENT_KEY}`\nconst EVENT_KEYDOWN = `keydown${EVENT_KEY}`\nconst EVENT_MOUSEENTER = `mouseenter${EVENT_KEY}`\nconst EVENT_MOUSELEAVE = `mouseleave${EVENT_KEY}`\nconst EVENT_DRAG_START = `dragstart${EVENT_KEY}`\nconst EVENT_LOAD_DATA_API = `load${EVENT_KEY}${DATA_API_KEY}`\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\n\nconst CLASS_NAME_CAROUSEL = 'carousel'\nconst CLASS_NAME_ACTIVE = 'active'\nconst CLASS_NAME_SLIDE = 'slide'\nconst CLASS_NAME_END = 'carousel-item-end'\nconst CLASS_NAME_START = 'carousel-item-start'\nconst CLASS_NAME_NEXT = 'carousel-item-next'\nconst CLASS_NAME_PREV = 'carousel-item-prev'\n\nconst SELECTOR_ACTIVE = '.active'\nconst SELECTOR_ITEM = '.carousel-item'\nconst SELECTOR_ACTIVE_ITEM = SELECTOR_ACTIVE + SELECTOR_ITEM\nconst SELECTOR_ITEM_IMG = '.carousel-item img'\nconst SELECTOR_INDICATORS = '.carousel-indicators'\nconst SELECTOR_DATA_SLIDE = '[data-bs-slide], [data-bs-slide-to]'\nconst SELECTOR_DATA_RIDE = '[data-bs-ride=\"carousel\"]'\n\nconst KEY_TO_DIRECTION = {\n  [ARROW_LEFT_KEY]: DIRECTION_RIGHT,\n  [ARROW_RIGHT_KEY]: DIRECTION_LEFT\n}\n\nconst Default = {\n  interval: 5000,\n  keyboard: true,\n  pause: 'hover',\n  ride: false,\n  touch: true,\n  wrap: true\n}\n\nconst DefaultType = {\n  interval: '(number|boolean)', // TODO:v6 remove boolean support\n  keyboard: 'boolean',\n  pause: '(string|boolean)',\n  ride: '(boolean|string)',\n  touch: 'boolean',\n  wrap: 'boolean'\n}\n\n/**\n * Class definition\n */\n\nclass Carousel extends BaseComponent {\n  constructor(element, config) {\n    super(element, config)\n\n    this._interval = null\n    this._activeElement = null\n    this._isSliding = false\n    this.touchTimeout = null\n    this._swipeHelper = null\n\n    this._indicatorsElement = SelectorEngine.findOne(SELECTOR_INDICATORS, this._element)\n    this._addEventListeners()\n\n    if (this._config.ride === CLASS_NAME_CAROUSEL) {\n      this.cycle()\n    }\n  }\n\n  // Getters\n  static get Default() {\n    return Default\n  }\n\n  static get DefaultType() {\n    return DefaultType\n  }\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n  next() {\n    this._slide(ORDER_NEXT)\n  }\n\n  nextWhenVisible() {\n    // FIXME TODO use `document.visibilityState`\n    // Don't call next when the page isn't visible\n    // or the carousel or its parent isn't visible\n    if (!document.hidden && isVisible(this._element)) {\n      this.next()\n    }\n  }\n\n  prev() {\n    this._slide(ORDER_PREV)\n  }\n\n  pause() {\n    if (this._isSliding) {\n      triggerTransitionEnd(this._element)\n    }\n\n    this._clearInterval()\n  }\n\n  cycle() {\n    this._clearInterval()\n    this._updateInterval()\n\n    this._interval = setInterval(() => this.nextWhenVisible(), this._config.interval)\n  }\n\n  _maybeEnableCycle() {\n    if (!this._config.ride) {\n      return\n    }\n\n    if (this._isSliding) {\n      EventHandler.one(this._element, EVENT_SLID, () => this.cycle())\n      return\n    }\n\n    this.cycle()\n  }\n\n  to(index) {\n    const items = this._getItems()\n    if (index > items.length - 1 || index < 0) {\n      return\n    }\n\n    if (this._isSliding) {\n      EventHandler.one(this._element, EVENT_SLID, () => this.to(index))\n      return\n    }\n\n    const activeIndex = this._getItemIndex(this._getActive())\n    if (activeIndex === index) {\n      return\n    }\n\n    const order = index > activeIndex ? ORDER_NEXT : ORDER_PREV\n\n    this._slide(order, items[index])\n  }\n\n  dispose() {\n    if (this._swipeHelper) {\n      this._swipeHelper.dispose()\n    }\n\n    super.dispose()\n  }\n\n  // Private\n  _configAfterMerge(config) {\n    config.defaultInterval = config.interval\n    return config\n  }\n\n  _addEventListeners() {\n    if (this._config.keyboard) {\n      EventHandler.on(this._element, EVENT_KEYDOWN, event => this._keydown(event))\n    }\n\n    if (this._config.pause === 'hover') {\n      EventHandler.on(this._element, EVENT_MOUSEENTER, () => this.pause())\n      EventHandler.on(this._element, EVENT_MOUSELEAVE, () => this._maybeEnableCycle())\n    }\n\n    if (this._config.touch && Swipe.isSupported()) {\n      this._addTouchEventListeners()\n    }\n  }\n\n  _addTouchEventListeners() {\n    for (const img of SelectorEngine.find(SELECTOR_ITEM_IMG, this._element)) {\n      EventHandler.on(img, EVENT_DRAG_START, event => event.preventDefault())\n    }\n\n    const endCallBack = () => {\n      if (this._config.pause !== 'hover') {\n        return\n      }\n\n      // If it's a touch-enabled device, mouseenter/leave are fired as\n      // part of the mouse compatibility events on first tap - the carousel\n      // would stop cycling until user tapped out of it;\n      // here, we listen for touchend, explicitly pause the carousel\n      // (as if it's the second time we tap on it, mouseenter compat event\n      // is NOT fired) and after a timeout (to allow for mouse compatibility\n      // events to fire) we explicitly restart cycling\n\n      this.pause()\n      if (this.touchTimeout) {\n        clearTimeout(this.touchTimeout)\n      }\n\n      this.touchTimeout = setTimeout(() => this._maybeEnableCycle(), TOUCHEVENT_COMPAT_WAIT + this._config.interval)\n    }\n\n    const swipeConfig = {\n      leftCallback: () => this._slide(this._directionToOrder(DIRECTION_LEFT)),\n      rightCallback: () => this._slide(this._directionToOrder(DIRECTION_RIGHT)),\n      endCallback: endCallBack\n    }\n\n    this._swipeHelper = new Swipe(this._element, swipeConfig)\n  }\n\n  _keydown(event) {\n    if (/input|textarea/i.test(event.target.tagName)) {\n      return\n    }\n\n    const direction = KEY_TO_DIRECTION[event.key]\n    if (direction) {\n      event.preventDefault()\n      this._slide(this._directionToOrder(direction))\n    }\n  }\n\n  _getItemIndex(element) {\n    return this._getItems().indexOf(element)\n  }\n\n  _setActiveIndicatorElement(index) {\n    if (!this._indicatorsElement) {\n      return\n    }\n\n    const activeIndicator = SelectorEngine.findOne(SELECTOR_ACTIVE, this._indicatorsElement)\n\n    activeIndicator.classList.remove(CLASS_NAME_ACTIVE)\n    activeIndicator.removeAttribute('aria-current')\n\n    const newActiveIndicator = SelectorEngine.findOne(`[data-bs-slide-to=\"${index}\"]`, this._indicatorsElement)\n\n    if (newActiveIndicator) {\n      newActiveIndicator.classList.add(CLASS_NAME_ACTIVE)\n      newActiveIndicator.setAttribute('aria-current', 'true')\n    }\n  }\n\n  _updateInterval() {\n    const element = this._activeElement || this._getActive()\n\n    if (!element) {\n      return\n    }\n\n    const elementInterval = Number.parseInt(element.getAttribute('data-bs-interval'), 10)\n\n    this._config.interval = elementInterval || this._config.defaultInterval\n  }\n\n  _slide(order, element = null) {\n    if (this._isSliding) {\n      return\n    }\n\n    const activeElement = this._getActive()\n    const isNext = order === ORDER_NEXT\n    const nextElement = element || getNextActiveElement(this._getItems(), activeElement, isNext, this._config.wrap)\n\n    if (nextElement === activeElement) {\n      return\n    }\n\n    const nextElementIndex = this._getItemIndex(nextElement)\n\n    const triggerEvent = eventName => {\n      return EventHandler.trigger(this._element, eventName, {\n        relatedTarget: nextElement,\n        direction: this._orderToDirection(order),\n        from: this._getItemIndex(activeElement),\n        to: nextElementIndex\n      })\n    }\n\n    const slideEvent = triggerEvent(EVENT_SLIDE)\n\n    if (slideEvent.defaultPrevented) {\n      return\n    }\n\n    if (!activeElement || !nextElement) {\n      // Some weirdness is happening, so we bail\n      // TODO: change tests that use empty divs to avoid this check\n      return\n    }\n\n    const isCycling = Boolean(this._interval)\n    this.pause()\n\n    this._isSliding = true\n\n    this._setActiveIndicatorElement(nextElementIndex)\n    this._activeElement = nextElement\n\n    const directionalClassName = isNext ? CLASS_NAME_START : CLASS_NAME_END\n    const orderClassName = isNext ? CLASS_NAME_NEXT : CLASS_NAME_PREV\n\n    nextElement.classList.add(orderClassName)\n\n    reflow(nextElement)\n\n    activeElement.classList.add(directionalClassName)\n    nextElement.classList.add(directionalClassName)\n\n    const completeCallBack = () => {\n      nextElement.classList.remove(directionalClassName, orderClassName)\n      nextElement.classList.add(CLASS_NAME_ACTIVE)\n\n      activeElement.classList.remove(CLASS_NAME_ACTIVE, orderClassName, directionalClassName)\n\n      this._isSliding = false\n\n      triggerEvent(EVENT_SLID)\n    }\n\n    this._queueCallback(completeCallBack, activeElement, this._isAnimated())\n\n    if (isCycling) {\n      this.cycle()\n    }\n  }\n\n  _isAnimated() {\n    return this._element.classList.contains(CLASS_NAME_SLIDE)\n  }\n\n  _getActive() {\n    return SelectorEngine.findOne(SELECTOR_ACTIVE_ITEM, this._element)\n  }\n\n  _getItems() {\n    return SelectorEngine.find(SELECTOR_ITEM, this._element)\n  }\n\n  _clearInterval() {\n    if (this._interval) {\n      clearInterval(this._interval)\n      this._interval = null\n    }\n  }\n\n  _directionToOrder(direction) {\n    if (isRTL()) {\n      return direction === DIRECTION_LEFT ? ORDER_PREV : ORDER_NEXT\n    }\n\n    return direction === DIRECTION_LEFT ? ORDER_NEXT : ORDER_PREV\n  }\n\n  _orderToDirection(order) {\n    if (isRTL()) {\n      return order === ORDER_PREV ? DIRECTION_LEFT : DIRECTION_RIGHT\n    }\n\n    return order === ORDER_PREV ? DIRECTION_RIGHT : DIRECTION_LEFT\n  }\n\n  // Static\n  static jQueryInterface(config) {\n    return this.each(function () {\n      const data = Carousel.getOrCreateInstance(this, config)\n\n      if (typeof config === 'number') {\n        data.to(config)\n        return\n      }\n\n      if (typeof config === 'string') {\n        if (data[config] === undefined || config.startsWith('_') || config === 'constructor') {\n          throw new TypeError(`No method named \"${config}\"`)\n        }\n\n        data[config]()\n      }\n    })\n  }\n}\n\n/**\n * Data API implementation\n */\n\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_SLIDE, function (event) {\n  const target = SelectorEngine.getElementFromSelector(this)\n\n  if (!target || !target.classList.contains(CLASS_NAME_CAROUSEL)) {\n    return\n  }\n\n  event.preventDefault()\n\n  const carousel = Carousel.getOrCreateInstance(target)\n  const slideIndex = this.getAttribute('data-bs-slide-to')\n\n  if (slideIndex) {\n    carousel.to(slideIndex)\n    carousel._maybeEnableCycle()\n    return\n  }\n\n  if (Manipulator.getDataAttribute(this, 'slide') === 'next') {\n    carousel.next()\n    carousel._maybeEnableCycle()\n    return\n  }\n\n  carousel.prev()\n  carousel._maybeEnableCycle()\n})\n\nEventHandler.on(window, EVENT_LOAD_DATA_API, () => {\n  const carousels = SelectorEngine.find(SELECTOR_DATA_RIDE)\n\n  for (const carousel of carousels) {\n    Carousel.getOrCreateInstance(carousel)\n  }\n})\n\n/**\n * jQuery\n */\n\ndefineJQueryPlugin(Carousel)\n\nexport default Carousel\n"],"names":["NAME","DATA_KEY","EVENT_KEY","DATA_API_KEY","ARROW_LEFT_KEY","ARROW_RIGHT_KEY","TOUCHEVENT_COMPAT_WAIT","ORDER_NEXT","ORDER_PREV","DIRECTION_LEFT","DIRECTION_RIGHT","EVENT_SLIDE","EVENT_SLID","EVENT_KEYDOWN","EVENT_MOUSEENTER","EVENT_MOUSELEAVE","EVENT_DRAG_START","EVENT_LOAD_DATA_API","EVENT_CLICK_DATA_API","CLASS_NAME_CAROUSEL","CLASS_NAME_ACTIVE","CLASS_NAME_SLIDE","CLASS_NAME_END","CLASS_NAME_START","CLASS_NAME_NEXT","CLASS_NAME_PREV","SELECTOR_ACTIVE","SELECTOR_ITEM","SELECTOR_ACTIVE_ITEM","SELECTOR_ITEM_IMG","SELECTOR_INDICATORS","SELECTOR_DATA_SLIDE","SELECTOR_DATA_RIDE","KEY_TO_DIRECTION","_KEY_TO_DIRECTION","Default","interval","keyboard","pause","ride","touch","wrap","DefaultType","Carousel","_BaseComponent","element","config","_this","call","_interval","_activeElement","_isSliding","touchTimeout","_swipeHelper","_indicatorsElement","SelectorEngine","findOne","_element","_addEventListeners","_config","cycle","_inheritsLoose","_proto","prototype","next","_slide","nextWhenVisible","document","hidden","isVisible","prev","triggerTransitionEnd","_clearInterval","_this2","_updateInterval","setInterval","_maybeEnableCycle","_this3","EventHandler","one","to","index","_this4","items","_getItems","length","activeIndex","_getItemIndex","_getActive","order","dispose","_configAfterMerge","defaultInterval","_this5","on","event","_keydown","Swipe","isSupported","_addTouchEventListeners","_this6","_iterator","_createForOfIteratorHelperLoose","find","_step","done","img","value","preventDefault","endCallBack","clearTimeout","setTimeout","swipeConfig","leftCallback","_directionToOrder","rightCallback","endCallback","test","target","tagName","direction","key","indexOf","_setActiveIndicatorElement","activeIndicator","classList","remove","removeAttribute","newActiveIndicator","add","setAttribute","elementInterval","Number","parseInt","getAttribute","_this7","activeElement","isNext","nextElement","getNextActiveElement","nextElementIndex","triggerEvent","eventName","trigger","relatedTarget","_orderToDirection","from","slideEvent","defaultPrevented","isCycling","Boolean","directionalClassName","orderClassName","reflow","completeCallBack","_queueCallback","_isAnimated","contains","clearInterval","isRTL","jQueryInterface","each","data","getOrCreateInstance","undefined","startsWith","TypeError","_createClass","get","BaseComponent","getElementFromSelector","carousel","slideIndex","Manipulator","getDataAttribute","window","carousels","_iterator2","_step2","defineJQueryPlugin"],"mappings":"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"}