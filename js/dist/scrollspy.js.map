{"version":3,"file":"scrollspy.js","sources":["../src/scrollspy.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap scrollspy.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport BaseComponent from './base-component.js'\nimport EventHandler from './dom/event-handler.js'\nimport SelectorEngine from './dom/selector-engine.js'\nimport {\n  defineJQueryPlugin, getElement, isDisabled, isVisible\n} from './util/index.js'\n\n/**\n * Constants\n */\n\nconst NAME = 'scrollspy'\nconst DATA_KEY = 'bs.scrollspy'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\n\nconst EVENT_ACTIVATE = `activate${EVENT_KEY}`\nconst EVENT_CLICK = `click${EVENT_KEY}`\nconst EVENT_LOAD_DATA_API = `load${EVENT_KEY}${DATA_API_KEY}`\n\nconst CLASS_NAME_DROPDOWN_ITEM = 'dropdown-item'\nconst CLASS_NAME_ACTIVE = 'active'\n\nconst SELECTOR_DATA_SPY = '[data-bs-spy=\"scroll\"]'\nconst SELECTOR_TARGET_LINKS = '[href]'\nconst SELECTOR_NAV_LIST_GROUP = '.nav, .list-group'\nconst SELECTOR_NAV_LINKS = '.nav-link'\nconst SELECTOR_NAV_ITEMS = '.nav-item'\nconst SELECTOR_LIST_ITEMS = '.list-group-item'\nconst SELECTOR_LINK_ITEMS = `${SELECTOR_NAV_LINKS}, ${SELECTOR_NAV_ITEMS} > ${SELECTOR_NAV_LINKS}, ${SELECTOR_LIST_ITEMS}`\nconst SELECTOR_DROPDOWN = '.dropdown'\nconst SELECTOR_DROPDOWN_TOGGLE = '.dropdown-toggle'\n\nconst Default = {\n  offset: null, // TODO: v6 @deprecated, keep it for backwards compatibility reasons\n  rootMargin: '0px 0px -25%',\n  smoothScroll: false,\n  target: null,\n  threshold: [0.1, 0.5, 1]\n}\n\nconst DefaultType = {\n  offset: '(number|null)', // TODO v6 @deprecated, keep it for backwards compatibility reasons\n  rootMargin: 'string',\n  smoothScroll: 'boolean',\n  target: 'element',\n  threshold: 'array'\n}\n\n/**\n * Class definition\n */\n\nclass ScrollSpy extends BaseComponent {\n  constructor(element, config) {\n    super(element, config)\n\n    // this._element is the observablesContainer and config.target the menu links wrapper\n    this._targetLinks = new Map()\n    this._observableSections = new Map()\n    this._rootElement = getComputedStyle(this._element).overflowY === 'visible' ? null : this._element\n    this._activeTarget = null\n    this._observer = null\n    this._previousScrollData = {\n      visibleEntryTop: 0,\n      parentScrollTop: 0\n    }\n    this.refresh() // initialize\n  }\n\n  // Getters\n  static get Default() {\n    return Default\n  }\n\n  static get DefaultType() {\n    return DefaultType\n  }\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n  refresh() {\n    this._initializeTargetsAndObservables()\n    this._maybeEnableSmoothScroll()\n\n    if (this._observer) {\n      this._observer.disconnect()\n    } else {\n      this._observer = this._getNewObserver()\n    }\n\n    for (const section of this._observableSections.values()) {\n      this._observer.observe(section)\n    }\n  }\n\n  dispose() {\n    this._observer.disconnect()\n    super.dispose()\n  }\n\n  // Private\n  _configAfterMerge(config) {\n    // TODO: on v6 target should be given explicitly & remove the {target: 'ss-target'} case\n    config.target = getElement(config.target) || document.body\n\n    // TODO: v6 Only for backwards compatibility reasons. Use rootMargin only\n    config.rootMargin = config.offset ? `${config.offset}px 0px -30%` : config.rootMargin\n\n    if (typeof config.threshold === 'string') {\n      config.threshold = config.threshold.split(',').map(value => Number.parseFloat(value))\n    }\n\n    return config\n  }\n\n  _maybeEnableSmoothScroll() {\n    if (!this._config.smoothScroll) {\n      return\n    }\n\n    // unregister any previous listeners\n    EventHandler.off(this._config.target, EVENT_CLICK)\n\n    EventHandler.on(this._config.target, EVENT_CLICK, SELECTOR_TARGET_LINKS, event => {\n      const observableSection = this._observableSections.get(event.target.hash)\n      if (observableSection) {\n        event.preventDefault()\n        const root = this._rootElement || window\n        const height = observableSection.offsetTop - this._element.offsetTop\n        if (root.scrollTo) {\n          root.scrollTo({ top: height, behavior: 'smooth' })\n          return\n        }\n\n        // Chrome 60 doesn't support `scrollTo`\n        root.scrollTop = height\n      }\n    })\n  }\n\n  _getNewObserver() {\n    const options = {\n      root: this._rootElement,\n      threshold: this._config.threshold,\n      rootMargin: this._config.rootMargin\n    }\n\n    return new IntersectionObserver(entries => this._observerCallback(entries), options)\n  }\n\n  // The logic of selection\n  _observerCallback(entries) {\n    const targetElement = entry => this._targetLinks.get(`#${entry.target.id}`)\n    const activate = entry => {\n      this._previousScrollData.visibleEntryTop = entry.target.offsetTop\n      this._process(targetElement(entry))\n    }\n\n    const parentScrollTop = (this._rootElement || document.documentElement).scrollTop\n    const userScrollsDown = parentScrollTop >= this._previousScrollData.parentScrollTop\n    this._previousScrollData.parentScrollTop = parentScrollTop\n\n    for (const entry of entries) {\n      if (!entry.isIntersecting) {\n        this._activeTarget = null\n        this._clearActiveClass(targetElement(entry))\n\n        continue\n      }\n\n      const entryIsLowerThanPrevious = entry.target.offsetTop >= this._previousScrollData.visibleEntryTop\n      // if we are scrolling down, pick the bigger offsetTop\n      if (userScrollsDown && entryIsLowerThanPrevious) {\n        activate(entry)\n        // if parent isn't scrolled, let's keep the first visible item, breaking the iteration\n        if (!parentScrollTop) {\n          return\n        }\n\n        continue\n      }\n\n      // if we are scrolling up, pick the smallest offsetTop\n      if (!userScrollsDown && !entryIsLowerThanPrevious) {\n        activate(entry)\n      }\n    }\n  }\n\n  _initializeTargetsAndObservables() {\n    this._targetLinks = new Map()\n    this._observableSections = new Map()\n\n    const targetLinks = SelectorEngine.find(SELECTOR_TARGET_LINKS, this._config.target)\n\n    for (const anchor of targetLinks) {\n      // ensure that the anchor has an id and is not disabled\n      if (!anchor.hash || isDisabled(anchor)) {\n        continue\n      }\n\n      const observableSection = SelectorEngine.findOne(decodeURI(anchor.hash), this._element)\n\n      // ensure that the observableSection exists & is visible\n      if (isVisible(observableSection)) {\n        this._targetLinks.set(decodeURI(anchor.hash), anchor)\n        this._observableSections.set(anchor.hash, observableSection)\n      }\n    }\n  }\n\n  _process(target) {\n    if (this._activeTarget === target) {\n      return\n    }\n\n    this._clearActiveClass(this._config.target)\n    this._activeTarget = target\n    target.classList.add(CLASS_NAME_ACTIVE)\n    this._activateParents(target)\n\n    EventHandler.trigger(this._element, EVENT_ACTIVATE, { relatedTarget: target })\n  }\n\n  _activateParents(target) {\n    // Activate dropdown parents\n    if (target.classList.contains(CLASS_NAME_DROPDOWN_ITEM)) {\n      SelectorEngine.findOne(SELECTOR_DROPDOWN_TOGGLE, target.closest(SELECTOR_DROPDOWN))\n        .classList.add(CLASS_NAME_ACTIVE)\n      return\n    }\n\n    for (const listGroup of SelectorEngine.parents(target, SELECTOR_NAV_LIST_GROUP)) {\n      // Set triggered links parents as active\n      // With both <ul> and <nav> markup a parent is the previous sibling of any nav ancestor\n      for (const item of SelectorEngine.prev(listGroup, SELECTOR_LINK_ITEMS)) {\n        item.classList.add(CLASS_NAME_ACTIVE)\n      }\n    }\n  }\n\n  _clearActiveClass(parent) {\n    parent.classList.remove(CLASS_NAME_ACTIVE)\n\n    const activeNodes = SelectorEngine.find(`${SELECTOR_TARGET_LINKS}.${CLASS_NAME_ACTIVE}`, parent)\n    for (const node of activeNodes) {\n      node.classList.remove(CLASS_NAME_ACTIVE)\n    }\n  }\n\n  // Static\n  static jQueryInterface(config) {\n    return this.each(function () {\n      const data = ScrollSpy.getOrCreateInstance(this, config)\n\n      if (typeof config !== 'string') {\n        return\n      }\n\n      if (data[config] === undefined || config.startsWith('_') || config === 'constructor') {\n        throw new TypeError(`No method named \"${config}\"`)\n      }\n\n      data[config]()\n    })\n  }\n}\n\n/**\n * Data API implementation\n */\n\nEventHandler.on(window, EVENT_LOAD_DATA_API, () => {\n  for (const spy of SelectorEngine.find(SELECTOR_DATA_SPY)) {\n    ScrollSpy.getOrCreateInstance(spy)\n  }\n})\n\n/**\n * jQuery\n */\n\ndefineJQueryPlugin(ScrollSpy)\n\nexport default ScrollSpy\n"],"names":["NAME","DATA_KEY","EVENT_KEY","DATA_API_KEY","EVENT_ACTIVATE","EVENT_CLICK","EVENT_LOAD_DATA_API","CLASS_NAME_DROPDOWN_ITEM","CLASS_NAME_ACTIVE","SELECTOR_DATA_SPY","SELECTOR_TARGET_LINKS","SELECTOR_NAV_LIST_GROUP","SELECTOR_NAV_LINKS","SELECTOR_NAV_ITEMS","SELECTOR_LIST_ITEMS","SELECTOR_LINK_ITEMS","SELECTOR_DROPDOWN","SELECTOR_DROPDOWN_TOGGLE","Default","offset","rootMargin","smoothScroll","target","threshold","DefaultType","ScrollSpy","_BaseComponent","element","config","_this","call","_targetLinks","Map","_observableSections","_rootElement","getComputedStyle","_element","overflowY","_activeTarget","_observer","_previousScrollData","visibleEntryTop","parentScrollTop","refresh","_inheritsLoose","_proto","prototype","_initializeTargetsAndObservables","_maybeEnableSmoothScroll","disconnect","_getNewObserver","_iterator","_createForOfIteratorHelperLoose","values","_step","done","section","value","observe","dispose","_configAfterMerge","getElement","document","body","split","map","Number","parseFloat","_this2","_config","EventHandler","off","on","event","observableSection","get","hash","preventDefault","root","window","height","offsetTop","scrollTo","top","behavior","scrollTop","_this3","options","IntersectionObserver","entries","_observerCallback","_this4","targetElement","entry","id","activate","_process","documentElement","userScrollsDown","_iterator2","_step2","isIntersecting","_clearActiveClass","entryIsLowerThanPrevious","targetLinks","SelectorEngine","find","_iterator3","_step3","anchor","isDisabled","findOne","decodeURI","isVisible","set","classList","add","_activateParents","trigger","relatedTarget","contains","closest","_iterator4","parents","_step4","listGroup","_iterator5","prev","_step5","item","parent","remove","activeNodes","_iterator6","_step6","node","jQueryInterface","each","data","getOrCreateInstance","undefined","startsWith","TypeError","_createClass","key","BaseComponent","_iterator7","_step7","spy","defineJQueryPlugin"],"mappings":"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"}